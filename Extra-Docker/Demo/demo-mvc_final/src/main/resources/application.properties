spring.application.name=demo-web

# --- Database Configuration ---
# The URL for the MySQL database. 
# 'localhost:3306' is the address, 'codingnomads' is the database name.
# useSSL=false is common for local development to simplify connection.
# If using a local MySQL installation instead of Docker, ensure the username and password match your setup.
spring.datasource.url=jdbc:mysql://localhost:3306/codingnomads?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=secret_password

# --- JPA / Hibernate Settings ---
# 'update' means Hibernate will automatically create or update database tables based on your Java @Entity classes.
# In production, this is usually set to 'validate' or managed via migration scripts like Flyway/Liquibase.
spring.jpa.hibernate.ddl-auto=update
# Disable show-sql as we use logback-spring.xml for structured logging
spring.jpa.show-sql=false
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect

# --- Logging Settings ---
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# --- Thymeleaf Settings ---
# Disable caching so that changes to HTML templates are visible immediately without restarting the server.
spring.thymeleaf.cache=false

# --- Spring Session (JDBC) ---
# We store sessions in the database instead of in-memory. 
# This allows the application to be restarted without logging everyone out.
spring.session.store-type=jdbc
# 'always' ensures that the necessary tables for Spring Session are created in your MySQL DB on startup.
spring.session.jdbc.initialize-schema=always
# A Cron expression that tells Spring to clean up expired sessions every 10 minutes.
# format: second, minute, hour, day of month, month, day of week
spring.session.jdbc.cleanup-cron=0 */10 * * * *

# --- Session & Cookie Security ---
# How long the user stays logged in (7 days).
server.servlet.session.timeout=7d
# http-only prevents JavaScript from accessing the cookie, protecting against XSS attacks.
server.servlet.session.cookie.http-only=true
# 'lax' is a sensible default for SameSite attribute to prevent CSRF while allowing some cross-site navigation.
server.servlet.session.cookie.same-site=lax


# --- Actuator ---
management.endpoints.access.default=unrestricted
management.endpoints.web.exposure.include=*
management.endpoint.env.show-values=when_authorized
management.endpoint.env.roles=ADMIN
management.endpoint.configprops.show-values=when_authorized
management.endpoint.configprops.roles=ADMIN
management.endpoint.sessions.access=unrestricted

# --- Spring Boot Admin Client ---
# see docker-compose service name
spring.boot.admin.client.url=http://admin:8081
# see docker-compose service name
spring.boot.admin.client.instance.service-url=http://app:8080
# Credentials for SBA to authenticate against our secured actuator endpoints
spring.boot.admin.client.instance.metadata.user.name=admin
spring.boot.admin.client.instance.metadata.user.password=admin